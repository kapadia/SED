Spine = require('spine')
SED   = require('models/SpectralEnergyDistribution')
SEDs  = require('controllers/SpectralEnergyDistributions')

class Results extends Spine.Controller
  elements:
    '#filters.types' : 'typesFilter'

  events:
    'click .sed'    : 'examine'
    'change .types' : 'filterByType'
    # 'mouseenter .object-name'   : 'showObjectNames'
    # 'mouseout   #object-names'  : 'hideObjectNames'

  constructor: ->
    super
    SED.bind "create", @addSedController

    @objectTypes = []
    @filterType = null

    @append require('views/results')()
    @active (params) ->
      @change()
      @getData params.ra, params.dec, params.radius

  change: () ->
    @render()

  render: ->
    @html require('views/results')()
    @

  getData: (ra, dec, radius) ->
    if SED.count() > 0
      @addSedController(sed) for sed in SED.all()
      @initializeFilter()
    else
      data = [{"object_name":"BD-13   239","type":"Star","ra":20.009752916666667,"dec":-13.065134444444446,"B":0.13595951262729228,"V":0.24946134641436993,"J":0.5892729031336401,"H":0.5556816757973325,"K":0.38547098136225555,"R":0.3264990310313247,"all_names":["2MASS J01200234-1303544","BD-13   239","GSC 05276-01712","PPM 210042","TYC 5276-1712-1","RAVE J012002.3-130355","USNO-B1.0 0769-00013052"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","2003AJ....125..984M","1998A&A...335L..65H"]},{"object_name":"TYC 5275-1412-1","type":"Star","ra":18.987592083333332,"dec":-13.523588611111109,"B":0.10505327576618294,"V":0.14092993837593792,"J":0.18651616237935353,"H":0.13244210530352077,"K":0.09349571119171093,"all_names":["2MASS J01155701-1331248","GSC 05275-01412","TYC 5275-1412-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5275-1529-1","type":"Star","ra":18.889091666666666,"dec":-13.73568888888889,"B":0.04143903173289876,"V":0.06870736006678438,"all_names":["TYC 5275-1529-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5275-1001-1","type":"Star","ra":19.006629166666663,"dec":-12.613133333333332,"B":0.01695936546557897,"V":0.040644638200989694,"all_names":["TYC 5275-1001-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"HD   7662","type":"Star","ra":19.1103825,"dec":-12.530573055555555,"B":0.18425089202091377,"V":0.25409917911006197,"J":0.31704176066247114,"H":0.2366061755119871,"K":0.1621779063285847,"all_names":["2MASS J01162648-1231500","BD-13   228","GSC 05275-00896","HD   7662","PPM 209961","TYC 5275-896-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5275-1024-1","type":"Star","ra":18.73334583333333,"dec":-12.550930555555556,"B":0.06940801099045214,"V":0.0948425586985937,"all_names":["TYC 5275-1024-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"BD-13   224","type":"Star","ra":18.714872083333336,"dec":-12.469679166666667,"B":0.12061729902105353,"V":0.16788166278212666,"J":0.20226301241811653,"H":0.15432137197440512,"K":0.10232734111044128,"all_names":["2MASS J01145156-1228108","BD-13   224","GSC 05275-00848","PPM 709856","TYC 5275-848-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"BD-13   225","type":"Star","ra":18.727327499999998,"dec":-12.8321325,"B":0.10409014154476318,"V":0.22961658947607608,"J":0.6728472335891029,"H":0.6607331182247198,"K":0.48349466852442075,"all_names":["2MASS J01145455-1249556","BD-13   225","GSC 05275-01091","PPM 209933","TYC 5275-1091-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5275-1009-1","type":"Star","ra":18.70128916666667,"dec":-12.474045555555556,"B":0.08578465304413779,"V":0.14223394704052478,"all_names":["GSC 05275-01009","TYC 5275-1009-1"],"bibcodes":["2000A&A...355L..27H","1998A&A...335L..65H"]},{"object_name":"HD   7543","type":"Star","ra":18.8382525,"dec":-13.90374,"B":0.5363022254243154,"V":0.6807744720341965,"J":0.7364045634725651,"H":0.548057437380082,"K":0.35415362340628637,"all_names":["2MASS J01152118-1354132","BD-14   240","GSC 05275-01383","HD   7543","PPM 209939","SAO 147696","TYC 5275-1383-1","YZ 104   312"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"BD-14   241","type":"Star","ra":18.85372625,"dec":-13.521296111111111,"B":0.12747047351950885,"V":0.15739946868406435,"J":0.20773825113423747,"H":0.15164429475644609,"K":0.10394214849658166,"all_names":["2MASS J01152489-1331166","BD-14   241","GSC 05275-01237","PPM 209944","TYC 5275-1237-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5275-1307-1","type":"Star","ra":18.636808333333335,"dec":-13.930781388888889,"B":0.07823653342663961,"V":0.10495503118916161,"J":0.07725319879594884,"H":0.05345964564069665,"K":0.035350184881406364,"all_names":["2MASS J01143283-1355506","GSC 05275-01307","TYC 5275-1307-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"BD-14   242","type":"Star","ra":18.91908375,"dec":-14.0043,"B":0.19293436903894268,"V":0.2517695838332787,"J":0.2683591892531508,"H":0.19770883438996867,"K":0.12647121461665073,"all_names":["2MASS J01154057-1400154","BD-14   242","GSC 05275-01690","PPM 209946","TYC 5275-1690-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5275-1362-1","type":"Star","ra":19.147224999999995,"dec":-13.444283333333335,"B":0.05826524797038319,"V":0.10023127665129801,"all_names":["TYC 5275-1362-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5275-1356-1","type":"Star","ra":18.94421625,"dec":-13.470858611111112,"B":0.0826817383854524,"V":0.13708920630225252,"J":0.13216500330171416,"H":0.09936331580219464,"K":0.06492196997915585,"all_names":["2MASS J01154660-1328149","GSC 05275-01356","TYC 5275-1356-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5275-1346-1","type":"Star","ra":18.563936666666667,"dec":-13.241622222222222,"B":0.052168650088691086,"V":0.05984160898017152,"J":0.12448484163429134,"H":0.10233544341723111,"K":0.06674084324504977,"all_names":["2MASS J01141534-1314298","GSC 05275-01346","TYC 5275-1346-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"IRAS 01139-1348","type":"IRAS Source","ra":19.110508314267,"dec":-13.548679194919,"B":0.3543313664897378,"V":1.3835767711051035,"J":15.188555453873436,"H":19.108477077628837,"K":14.790800847571655,"all_names":["2MASS J01162667-1332525","BD-14   244","GCRV 25796","GEN# +1.00007674","GSC 05275-01546","HD   7674","IRAS 01139-1348","PPM 209962","SAO 147703","TYC 5275-1546-1","YZ V11   315"],"bibcodes":["1988IRASP.C......0J"],"12um":1.229,"25um":0.3524,"60um":0.4,"100um":1.012},{"object_name":"TYC 5275-1643-1","type":"Star","ra":18.813311249999998,"dec":-14.029805555555555,"B":0.0826817383854524,"V":0.14355002154872776,"J":0.1425333429594625,"H":0.10261859770898826,"K":0.06950110179826954,"all_names":["2MASS J01151519-1401473","GSC 05275-01643","TYC 5275-1643-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5275-2329-1","type":"Star","ra":18.80049166666667,"dec":-13.299452777777777,"B":0.06814117201898484,"V":0.1250268421063528,"all_names":["TYC 5275-2329-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5275-1889-1","type":"Star","ra":18.80410833333334,"dec":-13.29923888888889,"B":0.08192370765157288,"V":0.1489372264480934,"all_names":["TYC 5275-1889-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-937-1","type":"Star","ra":19.51355416666667,"dec":-12.539977777777779,"B":0.03510828369955385,"V":0.041783350502071236,"all_names":["TYC 5276-937-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-771-1","type":"Star","ra":19.657029166666668,"dec":-12.5523,"B":0.049363915372208376,"V":0.05767707955544615,"all_names":["TYC 5276-771-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-682-1","type":"Star","ra":20.1608,"dec":-12.450080555555555,"B":0.06157573423377653,"V":0.1078954826328306,"all_names":["TYC 5276-682-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"BD-13   229","type":"Star","ra":19.330241249999997,"dec":-12.749091944444444,"B":0.15184818283958024,"V":0.1999876890835554,"J":0.2058336953999587,"H":0.14204504074620303,"K":0.09567350607078313,"all_names":["2MASS J01171925-1244567","BD-13   229","GSC 05276-00904","PPM 209985","TYC 5276-904-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5276-1129-1","type":"Star","ra":19.327758333333332,"dec":-13.255011111111113,"V":0.1059261681359299,"B":0.05169036502980809,"R":0.13118431041946918,"J":0.4076772447111665,"H":0.4123120958167553,"K":0.3028249746222133,"I":0.02334438935590526,"all_names":["RAVE J011718.7-131518","TYC 5276-1129-1","GSC 05276-01129","UCAC2  27021448","UCAC3 154-3292","2MASS J01171866-1315178","DENIS-P J011718.6-131517","USNO-B1.0 0767-00012318"],"bibcodes":["2000A&A...355L..27H","2003yCat.1289....0Z","2003yCat.2246....0C","2005yCat.2263....0T"]},{"object_name":"TYC 5276-1106-1","type":"Star","ra":19.401266666666668,"dec":-13.699113611111112,"B":0.11308619694015808,"V":0.17418199563123368,"J":0.26200915780551176,"H":0.21519197709537244,"K":0.14427520148858616,"all_names":["2MASS J01173630-1341566","GSC 05276-01106","TYC 5276-1106-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5276-995-1","type":"Star","ra":19.665767916666667,"dec":-12.893814722222222,"B":0.08818802145849836,"V":0.11091831464077184,"J":0.13839374801046614,"H":0.10366354960495108,"K":0.0688005150599957,"all_names":["2MASS J01183977-1253376","GSC 05276-00995","TYC 5276-995-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"HD   7968","type":"Star","ra":19.745586250000002,"dec":-12.64424111111111,"B":0.34151485500315126,"V":0.268536461560331,"J":0.1425333429594625,"H":0.07727269793904712,"K":0.05166443561532762,"all_names":["2MASS J01185894-1238393","BD-13   236","GEN# +1.00007968","GSC 05276-00961","HD   7968","PPM 210021","SB 533","TYC 5276-961-1","UBV M   8100"],"bibcodes":[null,"2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5276-1171-1","type":"Star","ra":19.25195875,"dec":-13.982548055555556,"B":0.05720178734447301,"V":0.09141201074846468,"J":0.12951392679168458,"H":0.1011174422562241,"K":0.06810699039361928,"all_names":["2MASS J01170045-1358574","GSC 05276-01171","TYC 5276-1171-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5276-986-1","type":"Star","ra":19.92707083333333,"dec":-12.532913888888888,"B":0.059348479805469936,"V":0.07194543818714222,"all_names":["TYC 5276-986-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"BD-13   237","type":"Star","ra":19.844208333333334,"dec":-12.69966888888889,"B":0.10219028235023027,"V":0.22131113324259294,"J":0.5844084289373561,"H":0.5883368835579131,"K":0.41076335225960137,"all_names":["2MASS J01192263-1241586","BD-13   237","GSC 05276-00985","PPM 210029","TYC 5276-985-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"BD-13   235","type":"Star","ra":19.739595833333333,"dec":-13.032775,"B":0.10799647965921085,"V":0.17418199563123368,"J":0.2094674140144872,"H":0.15981814138031228,"K":0.11076222964082719,"all_names":["TYC 5276-1444-1","2MASS J01185747-1301574","BD-13   235","PPM 210019"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1988A&AS...74..449R"]},{"object_name":"TYC 5276-1045-1","type":"Star","ra":19.40869166666667,"dec":-12.840763888888889,"B":0.0480186116330768,"V":0.05929297781133591,"all_names":["TYC 5276-1045-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-1201-1","type":"Star","ra":19.595658333333336,"dec":-13.71513888888889,"B":0.07680855576061768,"V":0.08260441540474756,"all_names":["TYC 5276-1201-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"HD   8048","type":"Star","ra":19.93631125,"dec":-13.285161944444445,"B":0.3921115175668513,"V":0.6870736006678438,"J":1.1023422956936075,"H":0.8855764842478553,"K":0.6053292912812385,"all_names":["2MASS J01194470-1317065","BD-14   255","GSC 05276-01256","HD   8048","PPM 210036","SAO 147737","TYC 5276-1256-1","YZ   0  5497","YZC 11   271"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5276-1192-1","type":"Star","ra":19.342974999999996,"dec":-13.402361111111112,"B":0.03383838279925442,"V":0.05211986258611827,"all_names":["TYC 5276-1192-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-1339-1","type":"Star","ra":19.933220833333337,"dec":-13.711466666666665,"B":0.02277244171031098,"V":0.03775750269155117,"all_names":["TYC 5276-1339-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"BD-14   254","type":"Star","ra":19.873597916666665,"dec":-13.335813055555557,"B":0.12864994328912577,"V":0.47973705197226685,"J":2.5229954723147423,"H":3.009026937715464,"K":2.307765568710669,"all_names":["2MASS J01192966-1320087","BD-14   254","GSC 05276-01234","PPM 210031","TYC 5276-1234-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5276-1275-1","type":"Star","ra":19.917437499999995,"dec":-13.211855555555555,"B":0.03291619292507691,"V":0.03475387718290745,"all_names":["TYC 5276-1275-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-1653-1","type":"Star","ra":19.506538333333335,"dec":-13.385109444444444,"J":0.10165212717992844,"H":0.06595171231586319,"K":0.04325055546863392,"V":0.13963788493464857,"B":0.1228597420331934,"all_names":["2MASS J01180155-1323064","GSC 05276-01653","SB 525","TYC 5276-1653-1"],"bibcodes":["2003yCat.2246....0C","2000A&A...355L..27H","1998A&A...335L..65H"]},{"object_name":"TYC 5276-1279-1","type":"Star","ra":19.412643749999997,"dec":-13.180381944444443,"B":0.07335160129440386,"V":0.1383576771105105,"J":0.2135583079102863,"H":0.1645985767708323,"K":0.11513084429240868,"all_names":["2MASS J01173905-1310493","GSC 05276-01279","TYC 5276-1279-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5276-1315-1","type":"Star","ra":19.598520833333335,"dec":-13.504480555555556,"B":0.029471999361146684,"V":0.06622214776894937,"all_names":["TYC 5276-1315-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-1955-1","type":"Star","ra":19.529295833333336,"dec":-13.91350277777778,"B":0.04419871051384734,"V":0.03349679551234907,"all_names":["TYC 5276-1955-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-1464-1","type":"Star","ra":20.18694583333333,"dec":-13.212969444444443,"B":0.023845673823691658,"V":0.060954147554504616,"all_names":["TYC 5276-1464-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-1615-1","type":"Star","ra":20.215958333333337,"dec":-13.64423888888889,"B":0.07201278368800301,"V":0.08491868533328994,"all_names":["TYC 5276-1615-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-1488-1","type":"Star","ra":20.03429958333333,"dec":-13.223390555555556,"B":0.10799647965921085,"V":0.12161951355655551,"J":0.13737777277847954,"H":0.09836171123016947,"K":0.06462368062238483,"all_names":["2MASS J01200822-1313241","GSC 05276-01488","TYC 5276-1488-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5276-1896-1","type":"Star","ra":19.483470833333328,"dec":-13.320566666666664,"B":0.043793494300187724,"V":0.08810554906719661,"all_names":["TYC 5276-1896-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"BD-14   253","type":"Star","ra":19.69796666666667,"dec":-13.517654444444442,"B":0.09940531345317079,"V":0.18239094018194169,"J":0.4794203571981231,"H":0.46518539989326374,"K":0.3369703503802569,"all_names":["2MASS J01184752-1331037","BD-14   253","GSC 05276-01839","PPM 210016","TYC 5276-1839-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"BD-14   247","type":"Star","ra":19.24618333333333,"dec":-13.907850833333333,"B":0.10125339621021962,"V":0.15031532563699482,"J":0.21613070552214747,"H":0.1560364552510148,"K":0.11005041623704047,"all_names":["2MASS J01165907-1354280","BD-14   247","GSC 05276-01766","PPM 209975","TYC 5276-1766-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"HD   7701","type":"Star","ra":19.15559125,"dec":-13.978249722222222,"B":0.29471999361146684,"V":0.3572755216711463,"J":0.3704388021066366,"H":0.26231678185133755,"K":0.16292648553198658,"all_names":["2MASS J01163733-1358416","BD-14   245","GSC 05276-01804","HD   7701","PPM 209964","TYC 5276-1804-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"TYC 5276-2029-1","type":"Star","ra":19.21021666666666,"dec":-13.418869444444443,"B":0.04030970307418278,"V":0.07603319878422087,"all_names":["TYC 5276-2029-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"TYC 5276-1902-1","type":"Star","ra":19.658208333333334,"dec":-13.717052777777777,"B":0.02341044122633482,"V":0.030269361636117816,"all_names":["TYC 5276-1902-1"],"bibcodes":["2000A&A...355L..27H"]},{"object_name":"BD-14   246","type":"Star","ra":19.25868416666667,"dec":-13.561127500000001,"V":0.20370573781735346,"B":0.11841578520654568,"J":0.26516516582233784,"H":0.2130227935653975,"K":0.13995605408332976,"R":0.17614969548229603,"I":0.024444576531383974,"all_names":["2MASS J01170207-1333399","BD-14   246","GSC 05276-01909","PPM 209977","TYC 5276-1909-1","RAVE J011702.1-133340","UCAC2  26806039","UCAC3 153-3331","DENIS-P J011702.0-133339","USNO-B1.0 0764-00012553"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","2003yCat.1289....0Z","2005yCat.2263....0T","1998A&A...335L..65H"]},{"object_name":"TYC 5276-2021-1","type":"Star","ra":19.761597083333335,"dec":-13.141290277777777,"B":0.08421890666876532,"V":0.15595642168131993,"J":0.24815125226193002,"H":0.2038102753361622,"K":0.14086129913958653,"all_names":["2MASS J01190278-1308285","GSC 05276-02021","TYC 5276-2021-1"],"bibcodes":["2000A&A...355L..27H","2003yCat.2246....0C","1998A&A...335L..65H"]},{"object_name":"6dFGS gJ011626.1-134719","type":"Galaxy","ra":19.108787500000002,"dec":-13.788663888888891,"J":0.01032562791495361,"H":0.01009313484953886,"K":0.008120666766878044,"B":0.001089957587821804,"R":0.0028699999999999997,"all_names":["2MASX J01162610-1347191","6dFGS gJ011626.1-134719"],"bibcodes":["2006AJ....131.1163S","2009MNRAS.399..683J"]},{"object_name":"6dFGS gJ011434.1-131144","type":"Galaxy","ra":18.641854166666665,"dec":-13.19545,"J":0.007934443485505278,"H":0.008032043940722102,"K":0.005975739946468617,"B":0.0008344678309135513,"R":0.00227972203365869,"all_names":["2MASX J01143404-1311436","6dFGS gJ011434.1-131144"],"bibcodes":["2006AJ....131.1163S","2009MNRAS.399..683J"]},{"object_name":"GALEX 2674410327787965748","type":"QSO_Candidate","ra":20.022079166666664,"dec":-13.526399999999999,"B":0.00015467125133206304,"R":0.0001373668364965971,"all_names":["GALEX 2674410327787965748","USNO-A2.0 0750-00314658"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"GALEX 2674410327787964469","type":"QSO_Candidate","ra":19.507779166666666,"dec":-13.806688888888889,"B":0.00012864994328912576,"R":5.996279895551097e-05,"all_names":["GALEX 2674410327787964469","USNO-A2.0 0750-00307238"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"GALEX 2674410323492995209","type":"QSO_Candidate","ra":19.58437083333333,"dec":-13.45573888888889,"B":0.00011733014276220599,"R":8.667261437553776e-05,"all_names":["GALEX 2674410323492995209","USNO-A2.0 0750-00308315"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"GALEX 2674410323492996832","type":"QSO_Candidate","ra":19.190029166666665,"dec":-13.008230555555556,"B":0.0002687878287485622,"R":0.00023871620230646654,"all_names":["GALEX 2674410323492996832","USNO-A2.0 0750-00302728"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"GALEX 2674410323492996724","type":"QSO_Candidate","ra":18.832179166666666,"dec":-13.057361111111112,"B":0.00016959365465578968,"R":0.00010420340171901899,"all_names":["GALEX 2674410323492996724","USNO-A2.0 0750-00297589"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"GALEX 2674410323492997569","type":"QSO_Candidate","ra":19.314720833333332,"dec":-12.869700000000002,"B":0.0002687878287485622,"R":0.00011425675794885361,"all_names":["GALEX 2674410323492997569","USNO-A2.0 0750-00304514"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"GALEX 2674410327787963429","type":"QSO_Candidate","ra":19.41325833333333,"dec":-14.022719444444446,"B":0.00015467125133206304,"R":9.503463186550374e-05,"all_names":["GALEX 2674410327787963429","USNO-A2.0 0750-00305914"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"GALEX 2674410327787963993","type":"QSO_Candidate","ra":19.42022916666666,"dec":-13.902800000000001,"B":0.0001070063619823082,"R":7.209114058432501e-05,"all_names":["GALEX 2674410327787963993","USNO-A2.0 0750-00306002"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"GALEX 2674410327787965179","type":"QSO_Candidate","ra":20.183979166666663,"dec":-13.647919444444444,"B":0.00014106185775158395,"R":0.00010420340171901899,"all_names":["USNO-A2.0 0750-00316979","GALEX 2674410327787965179"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"GALEX 2674410310608093252","type":"QSO_Candidate","ra":19.973808333333334,"dec":-12.533830555555555,"B":0.0002038964193294438,"R":0.0001252800438529278,"all_names":["GALEX 2674410310608093252","USNO-A2.0 0750-00313939"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"GALEX 2674410323492999286","type":"QSO_Candidate","ra":19.159179166666668,"dec":-12.532461111111111,"B":0.00018595574453431093,"R":0.00010420340171901899,"all_names":["GALEX 2674410323492999286","USNO-A2.0 0750-00302288"],"bibcodes":["1998USNO2.C......0M","2007ApJ...664...53A"]},{"object_name":"2MASS J01174705-1241035","type":"Star","ra":19.44625,"dec":-12.684444444444445,"I":0.002360383217496998,"J":0.026761870889319733,"H":0.02032479040364754,"K":0.013880071059123695,"B":0.015467125133206335,"R":0.02197262261835307,"all_names":["RAVE J011747.1-124104","DENIS-P J011747.0-124103","2MASS J01174705-1241035","USNO-B1.0 0773-00018358"],"bibcodes":["2005yCat.2263....0T","2003yCat.2246....0C","2003AJ....125..984M","2011AJ....141..187S"]},{"object_name":"2MASS J01201278-1345100","type":"Star","ra":20.05333333333333,"dec":-13.752777777777778,"J":0.03958370771546729,"H":0.03179992353473262,"K":0.02151749394849523,"B":0.02076871367840429,"R":0.02499665503173949,"all_names":["RAVE J012012.8-134510","2MASS J01201278-1345100","USNO-B1.0 0762-00013163"],"bibcodes":["2003yCat.2246....0C","2003AJ....125..984M","2011AJ....141..187S"]},{"object_name":"2MASX J01164197-1354551","type":"AGN","ra":19.174883333333337,"dec":-13.915327777777778,"J":0.0023589376995200016,"H":0.0028498767330806113,"all_names":["2MASX J01164197-1354551","6dFGS gJ011642.0-135455","NVSS J011641-135501"],"bibcodes":["2006AJ....131.1163S"]},{"object_name":"IRAS 01182-1409","type":"IRAS Source","bibcodes":["1988IRASP.C......0J"],"ra":20.16706114214,"dec":-13.891490324555,"12um":0.5846,"25um":0.2601,"60um":0.4,"100um":1.423},{"object_name":"IRAS 01162-1339","type":"IRAS Source","bibcodes":["1988IRASP.C......0J"],"ra":19.675133075785,"dec":-13.398465502683,"12um":0.6184,"25um":0.3362,"60um":0.4,"100um":1.0}]
      @initializeSedModel(sed) for sed in data
      @initializeFilter()
      # $.ajax({
      #   dataType: 'jsonp',
      #   url: @generateURL(ra, dec, radius),
      #   callback: 'givemeseds',
      #   success: (data) =>
      #     @initializeSedModel(sed) for sed in data
      #     @initializeFilter()
      #   error: (e) =>
      #     console.log 'oh well ...'
      # })

  generateURL: (ra, dec, radius = 30) ->
    return "http://www.milkywayproject.org/gator.json?radius=#{radius}&ra=#{ra}&dec=#{dec}"

  initializeSedModel: (sed) ->
    @objectTypes.push sed['type'] unless sed['type'] in @objectTypes

    params = {}
    params['objid']     = sed['object_name']
    params['ra']        = sed['ra']
    params['dec']       = sed['dec']
    params['bibcodes']  = sed['bibcodes']
    params['ra']        = sed['ra']
    params['names']     = sed['all_names']
    params['type']      = sed['type']
    delete sed['object_name']
    delete sed['ra']
    delete sed['dec']
    delete sed['bibcodes']
    delete sed['ra']
    delete sed['all_names']
    delete sed['type']
    params['fluxDensities'] = sed
    model = new SED params
    model.save()

  addSedController: (model) ->
    view = new SEDs {item: model, el: $("#results")}
    view.render()

  initializeFilter: ->
    $("#filters").append( require('views/types')({types: @objectTypes}) )
    if @filterType
      $("#types-filter option[value='#{@filterType}']").attr('selected', 'selected')
      $("#types-filter").trigger('change')

  filterByType: (e) ->
    @filterType = e.target.value
    for sed in SED.all()
      if @filterType is "all"
        $("##{sed.cid}").parent().show()
      else if sed.type is @filterType
        $("##{sed.cid}").parent().show()
      else
        $("##{sed.cid}").parent().hide()

  back: => Spine.navigate('/') if @.active?

  examine: (e) =>
    cid = $(e.currentTarget).children('.plot').first().attr("id")
    @navigate('/results', cid)
  
  showObjectNames: (e) ->
    cid = $(e.currentTarget).parent().attr("data-cid")
    names = SED.find(cid).names
    position = $(e.currentTarget).position()
    if names.length > 1
      $("#object-names").remove()
      html = "<div id='object-names'>"
      html += "<div class='object-name'>#{name}</div>" for name in names
      html += "</div>"
      $(html).css({
        position: 'fixed',
        display: 'none',
        left: position[0] - 240,
        top: position[1],
        border: '1px solid #FDD',
        padding: '2px',
        'background-color': '#FEE',
        opacity: 0.80
      }).appendTo("#results").show()

  hideObjectNames: (e) -> $("#object-names").remove()

module.exports = Results